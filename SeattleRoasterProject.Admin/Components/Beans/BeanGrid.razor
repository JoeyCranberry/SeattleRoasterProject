<SharedGrid>
    <GridHeader>
        <GridHeaderColumn Width="w-6" />
        <GridHeaderColumn Width="w-8">Image</GridHeaderColumn>
        <GridHeaderColumn>Name</GridHeaderColumn>
        <GridHeaderColumn Width="w-12">Date Added</GridHeaderColumn>
        <GridHeaderColumn Width="w-12">Processes</GridHeaderColumn>
        <GridHeaderColumn Width="w-8">Roast Level</GridHeaderColumn>
        <GridHeaderColumn Width="w-12">Origin</GridHeaderColumn>
    </GridHeader>
    <GridContent>
        @foreach (var bean in Beans)
        {
            <tr class="border-b border-neutral-700 odd:bg-neutral-800 even:bg-neutral-700 @(bean.IsExcluded ? "opacity-50" : "")">
                <GridCell>
                    <SharedButton @onclick="() => HandleBeanClicked(bean.Id)" ThemeColor="ButtonThemeEnum.PrimaryOutlined">
                        <i class="bi bi-pencil" />
                    </SharedButton>
                </GridCell>
                <GridCell Class="overflow-hidden text-ellipsis">
                    <img src="@bean.ImageURL"
                         class="@bean.ImageClass h-12 w-full object-cover"
                         alt="@bean.FullName"
                         onerror="this.onerror=null;this.src='/images/missing-image.png'"
                         loading="lazy" />
                </GridCell>
                <GridCell>
                    @bean.FullName
                </GridCell>
                <GridCell>
                    @bean.DateAdded.ToString("dd MMM yyyy")
                </GridCell>
                <GridCell>
                    @EnumHelper.ToCommaDelimitedList(bean.ProcessingMethods)
                </GridCell>
                <GridCell>
                    @bean.RoastLevel
                </GridCell>
                <GridCell>
                    @if (bean.Origins != null)
                    {
                        <ul>
                            @foreach (var origin in bean.Origins)
                            {
                                <li>@origin.GetOriginFullAddress()</li>
                            }
                        </ul>
                    }
                </GridCell>
            </tr>
        }
    </GridContent>
</SharedGrid>

@code {
    [Parameter]
    public List<BeanModel> Beans { get; set; } = new();

    [Parameter]
    public EventCallback<string> OnEditBeanClicked { get; set; }

    private async Task HandleBeanClicked(string beanId)
    {
        await OnEditBeanClicked.InvokeAsync(beanId);
    }
}
